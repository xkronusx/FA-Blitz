---
- hosts: localhost
  gather_facts: false
  tasks:
    - name: Check if Image Variable Exists
      stat:
        path: '/opt/coreapps'
      register: pathcheck

    - name: 'Transfer Image Variable'
      shell: 'rm -rf /opt/coreapps'
      when: pathcheck.stat.exists

    - name: Cloning GCE Apps
      git:
        repo: 'https://github.com/xkronusx/FA-Blitz'
        dest: /opt/FA-Blitz-Files
        version: 'master'
        force: yes
      command: mv /opt/FA-Blitz-Files/Apps-GCE-master/* /opt/coreapps

    - name: Set Permission and Owner
      shell: 'chown -R 1000:1000 /opt/coreapps && chmod -R 775 /opt/coreapps'
